<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" th:href="@{/css/procuOneHeader.css}">
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <title>계약 비교 페이지</title>
  <style>
    /* 테이블 스타일 */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #fff;
    }

    th, td {
      padding: 12px;
      text-align: center;
      border: 1px solid #ddd;
    }

    th {
      background-color: rgb(50, 146, 142); /* 테이블 헤더 색상 */
      color: white;
    }

    td {
      background-color: #f9f9f9;
    }

    tr:nth-child(even) td {
      background-color: #f2f2f2;
    }

    button {
      background-color: rgb(50, 146, 142); /* 버튼 색상 */
      color: white;
      border: none;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background-color: rgb(40, 126, 122); /* 버튼 hover 색상 */
    }

    .contract-button {
      text-decoration: none;
    }
  </style>
</head>
<body>
<div class="grid-container">
  <!-- 헤더-->
  <header class="layout-header">
    <div th:replace="partials/procuOneHeader :: header"></div>
  </header>

  <aside class="layout-sidebar">
    <div th:replace="partials/procuOneSide :: side"></div>
  </aside>

  <main class="layout-main">
    <header>
      <h1>계약 비교 페이지</h1>
      <p>다양한 회사들의 계약 조건을 비교하고, 원하는 계약을 선택하세요.</p>
    </header>

    <div id="productSelectWrapper">
      <label for="productSelect">품목 선택: </label>
      <select id="productSelect" onchange="updateTable()">
        <option value="">품목을 선택하세요</option>
        <!-- 품목을 동적으로 셀렉트 박스에 추가 -->
        <option th:each="item : ${items}"
                th:value="${item.productCode}"
                th:text="${item.itemName}"></option>
      </select>
    </div>

    <h2>계약 비교</h2>
    <table border="1" cellpadding="10">
      <thead>
      <tr>
        <th>회사명</th>
        <th>품목</th>
        <th>단가</th>
        <th>계약하기 버튼</th>
      </tr>
      </thead>
      <tbody>
      <!-- 테이블 내용은 JavaScript로 동적으로 갱신됨 -->
      </tbody>
    </table>

    <!-- 계약 관리 -->
<!--    <div class="form-section contract-management">-->
<!--      <h1>계약 관리</h1>-->
<!--      <div class="search-group">-->
<!--        &lt;!&ndash; 품목코드 셀렉트 (왼쪽 배치) &ndash;&gt;-->
<!--        <select>-->
<!--          <option>품목코드</option>-->
<!--        </select>-->

<!--        &lt;!&ndash; 여백 &ndash;&gt;-->
<!--        <div class="spacer"></div>-->

<!--        &lt;!&ndash; 텍스트 입력창 &ndash;&gt;-->
<!--        <input type="text">-->

<!--        &lt;!&ndash; 검색 버튼 &ndash;&gt;-->
<!--        <button type="submit">검색</button>-->
<!--      </div>-->

<!--      &lt;!&ndash; 테이블 &ndash;&gt;-->
<!--      <table>-->
<!--        <thead>-->
<!--        <tr>-->
<!--          <th>품목코드</th>-->
<!--          <th>품목명</th>-->
<!--          <th>계약번호</th>-->
<!--          <th>업체명</th>-->
<!--          <th>사업자번호</th>-->
<!--          <th>단가</th>-->
<!--          <th>L/T(소요시간)</th>-->
<!--          <th>계약서</th>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        <tbody>-->
<!--        <tr>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--          <td></td>-->
<!--        </tr>-->
<!--        </tbody>-->
<!--      </table>-->
<!--    </div>-->
  </main>

  <footer>
    <p>&copy; 2024 계약 비교 서비스</p>
  </footer>
</div>
<script>
  function updateTable() {
    const productCode = document.getElementById('productSelect').value;

    // Ajax 요청을 통해 서버에서 계약 정보 가져오기
    fetch(`/compare?productCode=${productCode}`)
            .then(response => response.json())
            .then(data => {
              const tableBody = document.getElementById('contractTableBody');
              tableBody.innerHTML = ''; // 기존 테이블 내용 초기화

              // 계약 정보가 있을 경우 테이블에 내용 추가
              data.forEach(companyItem => {
                const row = document.createElement('tr');
                row.innerHTML = `
            <td>${companyItem.company.name}</td>
            <td>${companyItem.item.itemName}</td>
            <td>${companyItem.unitCost}</td>
            <td><button class="contract-button">계약하기</button></td>
          `;
                tableBody.appendChild(row);
              });
            });
  }
</script>
</body>
</html>
